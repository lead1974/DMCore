@page
@model IndexModel
@{
    ViewData["Title"] = "DM Home";
}
@using DMCore.Data.Core.Domain
@using Kendo.Mvc.UI
<style>
    /*
    #dcListView {
        padding: 10px 5px;
        margin-bottom: -1px;
        min-height: 510px;
        /* Avoid cutout if font or line is bigger
        font: inherit;
    }

    .dCategory {
        float: left;
        position: relative;
        width: 111px;
        height: 170px;
        margin: 0 5px;
        padding: 0;
    }

    .k-dcListView:after {
        content: ".";
        display: block;
        height: 0;
        clear: both;
        visibility: hidden;
    }*/
</style>

@*
        <script type="text/x-kendo-template" id="template">
        <div>
            <i class="#: FAIcon #"></i><a href=""> #: ShortName #</a>
            <i class="#: FAIcon #"></i><a href=""> #: Name #</a>
            <i class="fas fa-dumbbell"></i><a href=""> #: SortSeq #</a>

        </div>
    </script>

    @(Html.Kendo().ListView(Model.dcList) //The ListView will be initially bound to the Model which is the Products table.
                                    .Name("dcListView") //The name of the ListView is mandatory. It specifies the "id" attribute of the widget.
                                    .TagName("div") //The tag name of the ListView is mandatory. It specifies the element which wraps all ListView items.
                                    .ClientTemplateId("template") //This template will be used for rendering the ListView items.
    )
*@
<a asp-page="/Deal/Post" class="btn btn-primary btn-lg" onclick="busyLoadShow()">
    <span class="fa fa-plus"></span>
    &nbsp; Post a Deal
</a>

<br />
<input class="k-textbox" id="searchCategories" /> <i>Minimum 3 charachters required to trigger search function</i>
<br />
<p>
    <table id="gridCategories">
        <colgroup>
            <col style="width:100px" />
            <col style="width:100px" />
            <col style="width:100px" />
            <col style="width:100px" />
            <col style="width:100px" />
        </colgroup>
        <thead>
            <tr>
                <th data-field="name">
                    Name
                </th>
                <th data-field="shortname">
                    Short Name
                </th>
                <th data-field="sortseq">
                    Sort Sequence
                </th>
                <th data-field="publiccategory">
                    Public Category
                </th>
                <th data-field="buttons"></th>
            </tr>
        </thead>
        <tbody>

            @foreach (var item in Model.dcList)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(m => item.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(m => item.ShortName)
                    </td>
                    <td>
                        @Html.DisplayFor(m => item.SortSeq)
                    </td>
                    <td>
                        @Html.DisplayFor(m => item.PublicCategory)
                    </td>
                    <td>
                        @*@Html.Partial("_TableButtonsPartial", new IndividualButtonPartial { Id = item.Id })*@
                    </td>
                </tr>
            }

        </tbody>
    </table>
</p>
@*
    <p>
    <br />
        <input class="k-textbox" id="searchTxt" /> <i>Minimum 3 charachters required to trigger search function</i>
        <br />
        <div id="example">
            <table id="gridCars">
                <colgroup>
                    <col />
                    <col />
                    <col style="width:110px" />
                    <col style="width:120px" />
                    <col style="width:130px" />
                </colgroup>
                <thead>
                    <tr>
                        <th data-field="make">Car Make</th>
                        <th data-field="model">Car Model</th>
                        <th data-field="year">Year</th>
                        <th data-field="category">Category</th>
                        <th data-field="airconditioner">Air Conditioner</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            Volvo
                            <span style="display:none">Volvo, S60, 2010, Saloon, Yes</span>
                        </td>
                        <td>S60</td>
                        <td>2010</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Audi</td>
                        <td>A4</td>
                        <td>2002</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>BMW</td>
                        <td>535d</td>
                        <td>2006</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>BMW</td>
                        <td>320d</td>
                        <td>2006</td>
                        <td>Saloon</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>VW</td>
                        <td>Passat</td>
                        <td>2007</td>
                        <td>Saloon</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>VW</td>
                        <td>Passat</td>
                        <td>2008</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Peugeot</td>
                        <td>407</td>
                        <td>2006</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Honda</td>
                        <td>Accord</td>
                        <td>2008</td>
                        <td>Saloon</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Alfa Romeo</td>
                        <td>159</td>
                        <td>2008</td>
                        <td>Saloon</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Nissan</td>
                        <td>Almera</td>
                        <td>2001</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Mitsubishi</td>
                        <td>Lancer</td>
                        <td>2008</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Opel</td>
                        <td>Vectra</td>
                        <td>2008</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Toyota</td>
                        <td>Avensis</td>
                        <td>2006</td>
                        <td>Saloon</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Toyota</td>
                        <td>Avensis</td>
                        <td>2008</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Toyota</td>
                        <td>Avensis</td>
                        <td>2008</td>
                        <td>Saloon</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Audi</td>
                        <td>Q7</td>
                        <td>2007</td>
                        <td>SUV</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Hyundai</td>
                        <td>Santa Fe</td>
                        <td>2012</td>
                        <td>SUV</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Hyundai</td>
                        <td>Santa Fe</td>
                        <td>2013</td>
                        <td>SUV</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Nissan</td>
                        <td>Qashqai</td>
                        <td>2007</td>
                        <td>SUV</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Mercedez</td>
                        <td>B Class</td>
                        <td>2007</td>
                        <td>Hatchback</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Lancia</td>
                        <td>Ypsilon</td>
                        <td>2006</td>
                        <td>Hatchback</td>
                        <td>Yes</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </p>*@
@*@(Html.Kendo().Grid<DealCategory>().Name("grid")
                                                .Groupable()
                                                .Sortable()
                                                .Editable()
                                                .Scrollable()
                                                .ToolBar(x => x.Excel())
                                                .Columns(columns =>
                                                {
                                                    columns.Bound(column => column.Name);
                                                    columns.Bound(column => column.ShortName);
                                                    columns.Bound(column => column.SortSeq);
                                                    columns.Command(column =>
                                                    {
                                                        column.Edit();
                                                        column.Destroy();
                                                    });
                                                })
                                                 .Excel(excel => excel
                                                            .FileName("Export.xlsx")
                                                            .Filterable(true)
                                                            .ProxyURL("/Index?handler=Save")
                                                        )
                                                .DataSource(ds => ds.Ajax()
                                                       .Read(r => r.Url("/Index?handler=Read").Data("forgeryToken"))
                                                       .Update(u => u.Url("/Index?handler=Update").Data("forgeryToken"))
                                                       .Create(c => c.Url("/Index?handler=Create").Data("forgeryToken"))
                                                       .Destroy(d => d.Url("/Index?handler=Destroy").Data("forgeryToken"))
                                                       .Model(m => m.Id(id => id.Id))
                                                    .PageSize(10)
                                                )
                                                .Pageable()
    )
    <script>
        function forgeryToken() {
            return kendo.antiForgeryTokens();
        }
    </script>*@

@*<table class="table">
        <tr>
            <th>
                @Html.DisplayNameFor(m => m.dcList[0].ShortName)
            </th>
            <th>
                @Html.DisplayNameFor(m => m.dcList[0].SortSeq)
            </th>
            <th></th>
        </tr>
        @foreach (var item in Model.dcList)
        {
            <tr>
                <td>
                    @Html.DisplayFor(m => item.ShortName)
                </td>
                <td>
                    @Html.DisplayFor(m => item.SortSeq)
                </td>
            </tr>
        }
    </table>*@
@*<script type="text/x-kendo-template" id="template2">*@

<ul class="portfolio-filter">
    <li><a class="btn btn-default active" href="#" data-filter="*">All</a></li>
    <li><a class="btn btn-default" href="#" data-filter=".bootstrap">Bootstrap</a></li>
    <li><a class="btn btn-default" href="#" data-filter=".html">HTML</a></li>
    <li><a class="btn btn-default" href="#" data-filter=".wordpress">Wordpress</a></li>
</ul><!--/#portfolio-filter-->
<ul class="portfolio-items col-3">
    <li class="portfolio-item apps">
        <div class="item-inner">
            <img src="images/portfolio/thumb/item1.jpg" alt="">
            <h5>Lorem ipsum dolor sit amet</h5>
            <div class="overlay">
                <a class="preview btn btn-danger" href="images/portfolio/full/item1.jpg" rel="prettyPhoto"><i class="icon-eye-open"></i></a>
            </div>
        </div>
    </li><!--/.portfolio-item-->
    <li class="portfolio-item joomla bootstrap">
        <div class="item-inner">
            <img src="images/portfolio/thumb/item2.jpg" alt="">
            <h5>Lorem ipsum dolor sit amet</h5>
            <div class="overlay">
                <a class="preview btn btn-danger" href="images/portfolio/full/item2.jpg" rel="prettyPhoto"><i class="icon-eye-open"></i></a>
            </div>
        </div>
    </li><!--/.portfolio-item-->
    <li class="portfolio-item bootstrap wordpress">
        <div class="item-inner">
            <img src="images/portfolio/thumb/item3.jpg" alt="">
            <h5>Lorem ipsum dolor sit amet</h5>
            <div class="overlay">
                <a class="preview btn btn-danger" href="images/portfolio/full/item3.jpg" rel="prettyPhoto"><i class="icon-eye-open"></i></a>
            </div>
        </div>
    </li><!--/.portfolio-item-->
    <li class="portfolio-item joomla wordpress apps">
        <div class="item-inner">
            <img src="images/portfolio/thumb/item4.jpg" alt="">
            <h5>Lorem ipsum dolor sit amet</h5>
            <div class="overlay">
                <a class="preview btn btn-danger" href="images/portfolio/full/item4.jpg" rel="prettyPhoto"><i class="icon-eye-open"></i></a>
            </div>
        </div>
    </li><!--/.portfolio-item-->
    <li class="portfolio-item joomla html">
        <div class="item-inner">
            <img src="images/portfolio/thumb/item5.jpg" alt="">
            <h5>Lorem ipsum dolor sit amet</h5>
            <div class="overlay">
                <a class="preview btn btn-danger" href="images/portfolio/full/item5.jpg" rel="prettyPhoto"><i class="icon-eye-open"></i></a>
            </div>
        </div>
    </li><!--/.portfolio-item-->
    <li class="portfolio-item wordpress html">
        <div class="item-inner">
            <img src="images/portfolio/thumb/item6.jpg" alt="">
            <h5>Lorem ipsum dolor sit amet</h5>
            <div class="overlay">
                <a class="preview btn btn-danger" href="images/portfolio/full/item6.jpg" rel="prettyPhoto"><i class="icon-eye-open"></i></a>
            </div>
        </div>
    </li><!--/.portfolio-item-->
</ul>
@*</script>*@
<form id="upload" method="post" action="http://dvbi03.venturafoods.com:9502/bi-lcm/v1/si/ssi/rpd/uploadrpd" enctype="multipart/form-data">
    <div class="demo-section k-content">
        <input name="files" id="files" type="file" aria-label="files" multiple /><br />
        <p style="padding-top: 1em; text-align: right">
            <button type="submit" class="k-button k-primary" id="btnUpload" asp-controller="Home" asp-action="Upload">Upload</button>
        </p>
    </div>
    <br />
    <div id="response" class="p-3 mb-2 bg-info text-white">@ViewBag.Result</div>
</form>

@section scripts
    {
    <script>
        $(document).ready(function () {

            //$("#pager").kendoPager({
            //    dataSource: {
            //        transport: {
            //            read: {
            //                url: "https://localhost:44310/api/dealcategory",
            //                dataType: "jsonp"
            //            }
            //        }
            //    }
            //});

            //var dataSource = new kendo.data.DataSource({
            //    transport: {
            //        read: {
            //            url: "https://localhost:44310/api/dealcategory",
            //            dataType: "jsonp"
            //        }
            //    },
            //    pageSize: 10
            //});

            //$("#dcListView").kendoListView({
            //    dataSource: dataSource,
            //    template: kendo.template($("#template").html())
            //});

            $("#gridCategories").kendoGrid({
                columns: [
                    { field: "name" },
                    { field: "shortname", filterable: false },
                    { field: "sortseq", filterable: false },
                    { field: "publiccategory", filterable: false },
                    { field: "buttons", filterable: false },

                ],
                toolbar: ["excel"],
                excel: {
                    fileName: "DealCategories.xlsx",
                    allPages: true
                },
                filterable: true,
                height: 500,
                groupable: true,
                sortable: true,
                pageable: {
                    messages: {
                        empty: "No items to display"
                    },
                    input: false,
                    refresh: true,
                    pageSizes: true,
                    pageSizes: [10, 20, 30, 50]
                }
            });

            $("#gridCategories").data("kendoGrid").dataSource.pageSize(10);

            $("#searchCategories").on("keyup change", function (e) {
                var grid = $("#gridCategories").data("kendoGrid");
                var searchTxt = $("#searchCategories").val();

                if (searchTxt.length >= 3) {

                    grid.dataSource.filter({
                        logic: "or", filters: [
                            { field: "name", operator: "contains", value: searchTxt },
                            { field: "shortname", operator: "contains", value: searchTxt },
                            { field: "sortseq", operator: "contains", value: searchTxt },
                            { field: "publiccategory", operator: "contains", value: searchTxt }]
                    });
                }
                else if (searchTxt.length == 0) {
                    grid.dataSource.filter([]);
                }
            });

            //$("#gridCars").kendoGrid({
            //    columns: [
            //        { field: "make" },
            //        { field: "model", filterable: false },
            //        { field: "year", filterable: false },
            //        { field: "category", filterable: false },
            //        { field: "airconditioner", filterable: false },

            //    ],
            //    toolbar: ["excel"],
            //    excel: {
            //        fileName: "Cars.xlsx",
            //        allPages: true
            //    },
            //    filterable: true,
            //    height: 430,
            //    sortable: true,
            //    pageable: {
            //        messages: {
            //            empty: "No items to display"
            //        },
            //        input: false,
            //        refresh: true,
            //        pageSizes: true,
            //        pageSizes: [10, 20, 30, 50]
            //    }
            //});

            //$("#gridCars").data("kendoGrid").dataSource.pageSize(10);


            //$("#searchTxt").on("keyup change", function (e) {
            //    var grid = $("#gridCars").data("kendoGrid");
            //    var searchTxt = $("#searchTxt").val();

            //    if (searchTxt.length >= 3) {

            //        grid.dataSource.filter({
            //            logic: "or", filters: [
            //                { field: "make", operator: "contains", value: searchTxt },
            //                { field: "model", operator: "contains", value: searchTxt },<img src="file:///C:\Users\aparahnevi\AppData\Local\Microsoft\Windows\INetCache\IE\RB6BKUFM\feb-19-t1-en-free-en[1].jpg" />
            //                { field: "year", operator: "contains", value: searchTxt },
            //                { field: "category", operator: "contains", value: searchTxt },
            //                { field: "airconditioner", operator: "contains", value: searchTxt }]
            //        });
            //    }
            //    else if (searchTxt.length == 0) {
            //        grid.dataSource.filter([]);
            //    }
            //});

            function getTheSubstring(value, length) {
                if (value.length > length)
                    return kendo.toString(value.substring(0, length)) + "...";
                else return kendo.toString(value);
            }

            $("#files").kendoUpload(
                {
                    //async: {

                    //    saveUrl: "~/uploadRPD",
                    //    autoUpload: true
                    //},
                    validation: {
                        /**/
                        allowedExtensions: [".rpd"]
                        /**/
                    }
                }
            )
        });
    </script>
}
